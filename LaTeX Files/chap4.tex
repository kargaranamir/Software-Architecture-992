% Chapter 2
\chapter{کارایی}
\section{تعریف کارایی}
کارایی\LTRfootnote{Performance} به توانایی سیستم در پاسخ گویی به نیاز ها در زمانی مشخص اشاره دارد.زمانی که رخدادی جدید نظیر خواسته ای از جانب کاربر یا سایر سیستم ها پیش می آید سیستم باید در بازه ی زمانی مورد انتظار آن رخداد را بررسی کند و به نیاز آن پاسخ دهد.در یک سیستم مبتی بر وب ممکن است کارایی با گزاره هایی نظیر تعداد درخواست بر دقیقه بیان شود.

کارایی در بیشتر اوقات درکنار گسترش پذیری\LTRfootnote{Scalability} شنیده می شود،‌گسترش پذیری به افزایش ظریفیت پاسخ دهی با حفظ کارایی اشاره دارد و نباید مفهوم آن با کارایی یکسان در نظر گرفته شود.
\section{سناریو عمومی کارایی}
سناریو کارایی با فرارسیدن رویداد ها به سیستم آغاز می شود.سیستم باید هم زمان با وجود سایر رویداد ها با تخصیص منابع به درخواست رویدادی که اکنون به سیستم رسیده پاسخ دهد.
رویداد ها می توانند با الگوی مشخص و تبعیت از یک توزیع ریاضی رخ دهند و یا آن که غیر قابل پیشبینی باشند؛‌الگوی فرارسیدن رویداد ها می تواند به صورت دوره ای\LTRfootnote{periodic}، تصادفی\LTRfootnote{Stochastic} و یا پراکنده\LTRfootnote{Sporadic} باشد.

در سناریو عمومی کارایی معیار سنجش پاسخ سیستم به محرک می تواند یکی از موارد زیر باشد:
\begin{itemize}
\item
تاخیر\LTRfootnote{Latency}: زمان میان فرارسیدن رویداد و پاسخ سیستم را تاخیر سیستم می گویند.
\item
مهلت های پردازشی\LTRfootnote{Deadlines in processing}:یک رویداد ممکن زمان مشخصی را برای سیستم به عنوان حداکثر زمانی که باید پاسخ رویداد آماده باشد مشخص کند،‌تخطی از این زمان سبب کاهش کارایی سیستم خواهد شد.
\item
توان عملیاتی سیستم\LTRfootnote{The throughput of the system}:تعداد پردازه هایی سیستم در واحد زمان می تواند به پایان برساند به عنوان توان عملیاتی شناخته می شود.
\end{itemize}
همچنین معیار های دیگری نظیر واریانس تاخیر\LTRfootnote{Jitter} و تعداد رویداد های بلوکه شده نیز وجود دارند که کارایی سیستم به وسیله ی آن ها قابل سنجش است.

در ادامه به معرفی بخش های مختلف سناریو عمومی کاریی می پردازیم.
\begin{itemize}
\item
منبع محرک\LTRfootnote{Source of stimulus} :
یک منبع از داخل و یا خارج از سیستم که بتواند رویدادی را ایجاد و به سیستم ارسال کند،‌می تواند منبع محرک سناریوی کارایی باشد.
\item
محرک\LTRfootnote{Stimulus} : 
فرارسیدن یک رویداد
\item
محصول\LTRfootnote{Artifact}: سیستم یا بخشی از آن که مسئول رسیدگی به رویداد است.
\item
محیط\LTRfootnote{Enviroment}:
سیستم می تواند در حالت های مختلف عملیاتی مانند حالت عادی\LTRfootnote{Normal} ، اضطراری\LTRfootnote{Emergency} ، اوج بار\LTRfootnote{Peak Load} یا اضافه بار\LTRfootnote{OverLoad} باشد.
\item
پاسخ\LTRfootnote{Response} :
سیستم در پاسخ رسیدن یک رویداد با تخصیص منابع به آن پاسخ می دهد که ممکن است به تغییر محیط نیز منجر شود.
\item
اندازه گیری پاسخ\LTRfootnote{Response Measure}:
معیار های سنجش کارایی سیستم پیش از این بررسی شدند.برای بررسی کارایی سیستم می توان به تاخیر،‌توان عملیاتی سیستم و مهلت های پردازشی اشاره کرد.
\end{itemize}

\section{تاکتیک ها در کارایی}
هدف تاکتیک ها در کارایی تولید پاسخ یک رویداد با توجه به محدودیت های زمانی حاکم بر کارایی است.زمان پاسخ سیستم عموما به زمان پردازش\LTRfootnote{Processing time} و یا زمان مسدود شدن \LTRfootnote{Blocking time} ختم می شود.

پردازش یک رویداد به منابع مختلفی نیاز دارد و توسط چندین مولفه\LTRfootnote{Component} سیستم نیاز به رسیدگی دارد.مجموع زمان هایی که مولفه های مختلف سیستم با به کار‌گیری منابع به یک رویداد رسیدگی می کنند،‌زمان پردازشی رویداد به حساب می آید.در کنار زمان پردازش،زمان مسدود شدن نیز نقش مهمی در مجموع زمان تاخیر یک رویداد دارد؛پردازش یک رویداد ممکن است به دلیل نیاز محاسباتی بخشی از پردازش به پردازشی دیگر و یا به دلیل در دسترس نبودن یک منبع مسدود شود.

تاکتیک هایی که در کارایی وجود دارند به دو دسته ی زیر تقسیم می شوند:
\begin{itemize}
\item
کنترل تقاضای منابع\LTRfootnote{Control resource demand} : این دسته از تاکتیک ها در سمت تقاضا فعالیت می کنند و سعی می کنند تا میزان تقاضا برای منابع را کاهش دهند.
\item
مدیریت منابع\LTRfootnote{Manage resources} : این دسته از تاکتیک ها سعی دارند تا کار‌ها را با بازدهی بیشتری انجام دهند تا مصرف منابع از این طریق کاهش یابد.
\end{itemize}
در ادامه به بررسی بیشتر این تاکتیک ها پرداخته می شود.
\subsection{کنترل درخواست منابع}
یکی از راه های افزایش کارایی، مدیریت دقیق تقاضای منابع است. این کار می تواند با کاهش تعداد رویدادهای پردازش شده با اعمال نرخ نمونه برداری یا با محدود کردن سرعت پاسخگویی سیستم به رویدادها انجام شود.
\begin{itemize}
\item
مدیریت نمونه برداری : با کاهش نرخ نمونه برداری از محیط هر چند مقداری از دقت کاسته خواهد شد اما میزان تقاضا رو می توان به مقدار خوبی کاهش داد.زمانی که جریان سازگار داده\LTRfootnote{Consistent Stream} اهمیت بیشتری داشته باشد چشم پوشی از مقداری دقت می تواند راه حل خوبی برای کاهش تقاضا به سیستم باشد.
\item
محدودیت پاسخ به رویداد ها : زمانی که رویداد‌های گسسته با نرخ بالایی به سیستم می رسند،‌باید در صف منتظر شروع پردازش بمانند.به دلیل گسسته بودن این رویداد ها امکان کاهش نرخ نمونه برداری وجود ندارد،در چنین شرایطی سیستم می تواند انتخاب کند که با توجه به شرایطی نظیر اندازه‌ی صف و یا زمانی که تاکنون رویداد در پردازش به خود اختصاص داده است،‌حداکثر زمانی که یک رویداد می تواند پردازش بگیرد را محمدود کند.با محدود کردن حداکثر زمان پردازشی که یک رویداد می تواند به خود اختصاص دهد،‌سیستم قادر خواهد بود تا رویداد های قابل پیش‌بینی بیشتری را تضمین کند.در این روش زمانی که تصمیم می گیرید رویدادی را رها\LTRfootnote{Drop} کنید باید سیاستی را برای مدیریت این وضعیت از پیش تعیین کنید‌:آیا رویداد های رها شده را ثبت می کنید و یا به راحتی آن ها را نادیده خواهید گرفت؟آیا سایر سیستم ها و کاربران را از رها سازی رویداد مطلع خواهید ساخت؟
\item 
اولویت‌بندی رویداد ها : اگر منابع کافی برای پاسخ دهی به تمامی رویداد ها در اختیار سیستم قرار ندارد و یا اگر همه ی رویداد‌ها از اهمیت یکسانی برخوردار نیستند استفاده از یک الگوریتم الویت بندی می تواند تاثیر خوبی در کارایی سیستم داشته باشد.
\item
کاهش سربار : هر چند وجود واسطه ها در افزایش اطلاح پذیری\LTRfootnote{Modifiability} از اهمیت بالایی برخوردار است اما حذف این واسطه ها می تواند منجر به افزایش کارایی سیستم شود.معماری در این مساله با تقابل دو نیاز کارایی و اصلاح پذیری دست و پنجه نرم می کند و باید بهترین تصمیم را با توجه به نیاز ها و اهداف سیستم اخذ کند.
\item
زمان اجرای محدود : محدودیتی در میزان استفاده از زمان اجرا برای پاسخگویی به یک رویداد تعیین کنید. برای الگوریتم های تکراری و وابسته به داده ها ، محدود کردن تعداد تکرارها روشی برای محدود کردن زمان پردازش است که هر چند می تواند به پاسخی با دقت کمتر ختم شود اما در افزایش کارایی تاثیر مثبتی دارد.
\item
افزایش بازدهی منابع : بهبود الگوریتم های مورد استفاده در مناطق بحرانی
تاخیر را کاهش می دهد.
\end{itemize}
\subsection{مدیریت منابع}
هر چند ممکن است کنترل تقضا برای منابع همواره ممکن نباشد اما مدیریت منابع همیشه در اختیار سیستم قرار دارد.گاهی می توان برای انجام یک پردازش از منابع مختلف استفاده کرد به عنوان مثال می توانید داده های میانی را در حافظه ی نهان\LTRfootnote{Cache} نگهداری کنید و یا از حافظه های دیگر سیستم به منظور ذخیره سازی آن ها استفاده کنید.در ادامه چندین روش مدیریت منابع سیستم مطرح می شوند:
\begin{itemize}
\item
افزایش تعداد منابع : افزایش کمیت و کیفیت منابع همواره یکی از راه های کاهش تاخیر رویداد هاست که البته دغدغه های مالی را بر سر راه خود دارد.
\item 
استفاده از هم‌زمانی\LTRfootnote{Concurrency} : اگر درخواست ها قابلیت پردازش موازی را داشته باشند،‌استفاده از هم‌زمانی و پردازش موازی همراه با الگوریتم‌هایی جهت مدیریت پردازش رویداد ها بر نخ های پردازشی متفاوت به جهت حفظ توان عملیاتی و عدالت می تواند کارایی سیستم را به مقدار خوبی افزایش دهد.
\item
حفظ چندین نسخه از محاسبات : وجود چندین سیستم مشابه برای پاسخ به رویداد ها، در زمانی که چندین رویداد هم‌زمان با یکدیگر رخ می دهند می تواند کارایی سیستم را تا حد زیادی افزایش دهد.برای مثال وجود چنین سرور در معماری های کلاینت-سرور\LTRfootnote{Client-Server} به همراه یک نرم افزار متعادل کننده ی بار\LTRfootnote{Load Balancer} می تواند به کارایی سیستم در پاسخ به رویداد ها کمک زیادی کند.
\item 
حفظ چندین نسخه از داده : تکثیر داده ها\LTRfootnote{Data Replication} شامل نگهداری نسخه های جداگانه از داده ها برای کاهش نزاع میان رویداد ها هنگام چندین دسترسی همزمان است. از آنجا که داده های تکثیر شده معمولاً یک کپی از داده های موجود است ، حفظ کپی و هماهنگ سازی کپی ها به مسئولیتی تبدیل می شود که سیستم باید آن را بر عهده بگیرد.
\item
محدود‌سازی اندازه ی صف : این روش که اصولا در کنار محدودیت پاسخ به رویداد ها استفاده می شود،‌اقدام به محدود سازی اندازه صف ورودی رویداد ها می کند.در این روش باید سیاست مشخصی در برابر رویداد هایی که به دلیل محدودیت اندازه ی صف پذیرش نمی شوند،‌اتخاذ شود.
\item
برنامه‌ریزی منابع : در این روش هدف درک ویژگی های استفاده از هر منبع و انتخاب استراتژی برنامه ریزی سازگار با آن است.
\end{itemize}
\section{طراحی فهرست بازبینی برای کارائی}
در ادامه سعی شده است تا فهرستی را برای پشتیبانی از روند طراحی 	و تجزیه و تحلیل نیاز کارایی ارائه شود.
\subsection{تخصیص مسئولیت ها} 
در زمان تخصیص مسئولیت ها باید \LTRfootnote{Allocation of Responsibilities} به موارد زیر توجه شود:
\begin{itemize}
\item
مسئولیت های سیستم در شرایط مختلف نظیر بارسنگین \LTRfootnote{Heavey Load} یا نیاز بحرانی به پاسخ یک رویداد تعیین کنید.برای این مسئولیت ها ، الزامات پردازش هر مسئولیت را شناسایی کرده و تعیین کنید که آیا ممکن است موجب گلوگاه\LTRfootnote{Bottleneck} های مختلف شود.
\item
مسئولیت هایی که از وجود یک رشته کنترلی میان فرآیند ها و یا مرز های پردازشی حاصل می شوند،‌راشناسایی کنید.
\item
مسئولیت کنترل رشته های پردازشی در هنگام استفاده از روش های چند‌رشته ای\LTRfootnote{Multi-Threading}.
\item
اطمینان حاصل کنید سیستم با وجود مسئولیت هایی که به عهده اش گذاشته شده است،‌می تواند به نیاز های کارایی پاسخ دهد.می توانید با استفاده از مدل سازی یا سایر روش ها اندازه گیری کارایی به این مهم دست یابید.
\end{itemize}
\subsection{مدل هماهنگی}
عناصر سیستم را که باید هماهنگ شوند - مستقیم یا غیرمستقیم - تعیین کنید و رویکرد های ارتباطی و هماهنگی را انتخاب کنید که موارد زیر را انجام می دهند:
\begin{itemize}
\item
پشتیبانی از هم‌زمانی رویداد ها و روش های الویت بندی و استراتژی های برنامه‌ریزی
\item
اطمینان حاصل کنید که می توان پاسخ کارایی مورد نیاز را ارائه داد.
\item
سیستم در صورت لزوم می تواند ورودهای دوره ای ، تصادفی یا پراکنده را پذیرش کند
\item
از خصوصیات مناسب مکانیسم های ارتباطی برخوردار باشند.
\end{itemize}
\subsection{مدل داده}
مدل داده\LTRfootnote{Data Model}   ای آن بخش از داده ها که قرار است بار زیادی را متحمل شوند و در کارایی سیستم اثر گذار هستند را مشخص کنید و موارد زیر را در مورد آن ها بررسی نمائید.
\begin{itemize}
\item
اینکه آیا حفظ چندین نسخه از داده های کلیدی به نفع عملکرد است یا خیر؟
\item
آیا تقسیم\LTRfootnote{Partitioning} داده ها به نفع کارایی است؟
\item
آیا کاهش نیاز های پردازشی برای عملیات هایی که نیاز به تغییر در داده ها دارند امکان پذیر است؟
\item
آیا امکان افزایش منابع به جهت کاهش گلوگاه ها در هنگام تغییر در داده ها امکان پذیر است؟
\end{itemize}
\subsection{نقشه برداری در میان عناصر معماری}
جدا از ملاحظاتی که در نقشه برداری در میان عناصر معماری\LTRfootnote{Mapping among Architectural Elements} درباره امنیت،‌ دسترس‌پذیری و کارائی وجود دارد و در سایر فصل های این مستند به آن ها پرداخته خواهد شد؛ در رابطه با قابلیت همکاری مساله ی مهم نگاشت درست از اعضای سازنده ی پردازنده ها است.
\subsection{مدیریت منابع}
لازم است معمار نرم افزار اطمینان حاصل کند منابعی که سیستم به جهت همکاری با سایر سیستم ها نیاز دارد هیچ گاه سیستم را تحت فشار غیر قابل تحمل قرار نخواهد داد و بار منابع تحمیل شده توسط الزامات همکاری همواره قابل قبول است.

در ضمن نیاز یک سیستم ناظر با هدف تخصیص منابع به صورت منصفانه و بر پایه ی سیاست های تبیین شده در معماری باید حتما دیده شود.
\subsection{زمان اتصال}
لازم است سیستم هایی که ممکن است با یکدیگر همکاری داشته باشند شناسایی شده و از رعایت موارد زیر در مورد آن ها اطمینان حاصل شود.
\begin{itemize}
\item
از وجود یک سیاست مشخص به منظور همکاری با سیستم های شناخته شده و ناشناخته خارجی اطمینان حاصل کنید.
\item
از وجود قوانینی برای عدم پذیرش درخواست ها و ثبت درخواست هایی که پذیرفته نشده اند اطمینان حاصل کنید.
\item
در صورت تاخیر در اتصال ، اطمینان حاصل کنید که مکانیزم هایی از کشف خدمات یا پروتکل های جدید مرتبط یا ارسال اطلاعات با استفاده از پروتکل های انتخاب شده پشتیبانی می کنند.
\end{itemize}
\subsection{انتخاب فناوری}
در انتخاب فناوری باید روی این مساله تمرکز نمائید که انتخاب هر فناوری چه تاثیراتی بر روی رابط ها و همکاری سیستم با دیگر سیستم ها خواهد داشت.بررسی کنید آیا فناوری آیای انتخاب شده توانایی پاسخ گویی به نیاز هایی که توسط قابلیت همکاری مطرح می شوند را دارا هستند و یا خیر؟








